import json
import os
from datetime import datetime

MIND_PATH = os.path.abspath(os.path.join(os.path.dirname(__file__), "..", "db", "shadow_mind.json"))
EXPORT_PATH = os.path.abspath(os.path.join(os.path.dirname(__file__), "..", "reports", "exploit_examples.txt"))

def generate_exploits():
    if not os.path.exists(MIND_PATH):
        print("[!] ShadowMind fajl ne postoji.")
        return

    with open(MIND_PATH, "r") as f:
        data = json.load(f)

    with open(EXPORT_PATH, "w") as out:
        out.write(f"# ShadowFox Exploit Primeri – {datetime.now().isoformat()}\n\n")
        for vector, payloads in data.items():
            if not payloads:
                continue
            out.write(f"## {vector.upper()} Exploits\n")
            for p in payloads:
                if vector == "xss":
                    out.write(f"- <a href='http://target.site?q={p}'>{p}</a>\n")
                elif vector == "sqli":
                    out.write(f"- http://target.site/login?user=admin&pass={p}\n")
                elif vector == "lfi":
                    out.write(f"- http://target.site/view?file={p}\n")
            out.write("\n")

    print(f"[✓] Exploiti generisani: {EXPORT_PATH}")

if __name__ == "__main__":
    generate_exploits()
